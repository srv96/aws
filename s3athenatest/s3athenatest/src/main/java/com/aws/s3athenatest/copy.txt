import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Properties;

public class AthenaJdbcExample {

    public static void main(String[] args) {

        // Set up the JDBC URL and properties for the Athena connection
        String jdbcUrl = "jdbc:awsathena://athena.{REGION}.amazonaws.com:443";
        Properties properties = new Properties();
        properties.setProperty("aws_credentials_provider_class", "com.amazonaws.auth.DefaultAWSCredentialsProviderChain");
        properties.setProperty("s3_staging_dir", "s3://{BUCKET_NAME}/athena/");
        properties.setProperty("region_name", "{REGION}");

        // Create the Athena JDBC driver and establish a connection
        try (Connection conn = DriverManager.getConnection(jdbcUrl, properties)) {

            // Create a statement and execute a query
            try (Statement statement = conn.createStatement()) {
                String query = "SELECT * FROM mydatabase.mytable";
                try (ResultSet resultSet = statement.executeQuery(query)) {
                    while (resultSet.next()) {
                        String column1Value = resultSet.getString("column1");
                        int column2Value = resultSet.getInt("column2");
                        System.out.println("column1 = " + column1Value + ", column2 = " + column2Value);
                    }
                }
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }

    }

}
