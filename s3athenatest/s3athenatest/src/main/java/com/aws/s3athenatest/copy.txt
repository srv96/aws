import java.sql.*;

public class AthenaQueryExample {

    public static void main(String[] args) throws SQLException {
        String url = "jdbc:awsathena://athena.{REGION}.amazonaws.com:443/";
        String user = "aws";
        String password = "";
        String query = "SELECT * FROM mydatabase.mytable LIMIT 10;";

        String profileName = "default";
        String proxyHost = "YOUR_PROXY_HOST";
        int proxyPort = 8080;
        String proxyUser = "YOUR_PROXY_USER";
        String proxyPassword = "YOUR_PROXY_PASSWORD";

        // Set the AWS SDK credentials provider
        com.amazonaws.auth.profile.ProfileCredentialsProvider credentialsProvider =
                new com.amazonaws.auth.profile.ProfileCredentialsProvider(profileName);

        // Set the AWS SDK client configuration
        com.amazonaws.ClientConfiguration clientConfiguration = new com.amazonaws.ClientConfiguration();
        clientConfiguration.setProxyHost(proxyHost);
        clientConfiguration.setProxyPort(proxyPort);
        clientConfiguration.setProxyUsername(proxyUser);
        clientConfiguration.setProxyPassword(proxyPassword);

        // Create the JDBC connection
        java.util.Properties properties = new java.util.Properties();
        properties.put("user", user);
        properties.put("password", password);
        properties.put("aws_credentials_provider_class",
                "com.amazonaws.auth.profile.ProfileCredentialsProvider");
        properties.put("aws_credentials_provider_arguments",
                profileName);
        properties.put("s3_staging_dir", "s3://mybucket/myfolder/");
        properties.put("aws_client_configuration_class",
                "com.amazonaws.ClientConfiguration");
        properties.put("aws_client_configuration_arguments",
                clientConfiguration);

        Connection connection = DriverManager.getConnection(url, properties);

        // Execute the query
        Statement statement = connection.createStatement();
        ResultSet resultSet = statement.executeQuery(query);

        // Process the results
        while (resultSet.next()) {
            System.out.println(resultSet.getString(1) + ", " + resultSet.getString(2));
        }

        // Close the connection
        resultSet.close();
        statement.close();
        connection.close();
    }
}
