
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import com.amazonaws.auth.profile.ProfileCredentialsProvider;

public class AthenaPreparedStatementExample {

    private static final String ATHENA_URL = "jdbc:awsathena://athena.us-east-1.amazonaws.com:443";
    private static final String DATABASE = "mydatabase";
    private static final String TABLE = "mytable";

    public static void main(String[] args) {

        // Set up the credentials provider
        ProfileCredentialsProvider credentialsProvider = new ProfileCredentialsProvider();

        try (Connection conn = DriverManager.getConnection(ATHENA_URL, credentialsProvider)) {

            // Create a prepared statement to retrieve data from Athena
            String selectSql = "SELECT * FROM \"" + DATABASE + "\".\"" + TABLE + "\" WHERE column1 = ?";
            try (PreparedStatement selectStatement = conn.prepareStatement(selectSql)) {

                // Set the value of the parameter in the prepared statement
                selectStatement.setString(1, "value1");

                // Execute the query and retrieve the results
                try (ResultSet resultSet = selectStatement.executeQuery()) {
                    while (resultSet.next()) {
                        String column2Value = resultSet.getString("column2");
                        int column3Value = resultSet.getInt("column3");
                        System.out.println("column2 = " + column2Value + ", column3 = " + column3Value);
                    }
                }
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }

    }

}
