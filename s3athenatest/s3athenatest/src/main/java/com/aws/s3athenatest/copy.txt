private static void createAndCopyRow(Sheet sheet, Row sourceRow, Row targetRow, short fillColor) {
    if (sourceRow != null) {
        for (int i = 0; i < sourceRow.getLastCellNum(); i++) {
            Cell sourceCell = sourceRow.getCell(i);
            Cell targetCell = targetRow.createCell(i);

            if (sourceCell != null) {
                targetCell.setCellValue(sourceCell.toString());
                targetCell.setCellStyle(sourceCell.getCellStyle());
                targetCell.getCellStyle().setFillForegroundColor(fillColor);
                targetCell.getCellStyle().setFillPattern(FillPatternType.SOLID_FOREGROUND);
            }
        }
    }
}
