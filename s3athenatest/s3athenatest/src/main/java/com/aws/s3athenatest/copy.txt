private static void createAndCopyRow(Sheet sheet, Row sourceRow, Row targetRow, short fillColor) {
    if (sourceRow != null) {
        for (int i = 0; i < sourceRow.getLastCellNum(); i++) {
            Cell sourceCell = sourceRow.getCell(i);
            Cell targetCell = targetRow.createCell(i);

            if (sourceCell != null) {
                targetCell.setCellValue(sourceCell.toString());
                // Create a new cell style and copy relevant properties from the source style
                CellStyle newCellStyle = sheet.getWorkbook().createCellStyle();
                newCellStyle.cloneStyleFrom(sourceCell.getCellStyle());
                targetCell.setCellStyle(newCellStyle);
            }
        }

        // Set the fill foreground color for the entire row
        CellStyle targetRowStyle = sheet.getWorkbook().createCellStyle();
        targetRowStyle.setFillForegroundColor(fillColor);
        targetRowStyle.setFillPattern(FillPatternType.SOLID_FOREGROUND);
        targetRow.setRowStyle(targetRowStyle);
    }
}
