import com.opencsv.CSVReader;
import com.opencsv.exceptions.CsvException;

import java.io.FileReader;
import java.io.IOException;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Types;

public class ResultSetCreator {
    public static ResultSet createResultSetFromFile(String filePath) throws IOException, CsvException, SQLException {
        CSVReader reader = new CSVReader(new FileReader(filePath));
        String[] header = reader.readNext();
        String[][] data = reader.readAll();
        reader.close();

        // Create a SimpleResultSet
        SimpleResultSet resultSet = new SimpleResultSet();

        // Set column names and types
        for (int i = 0; i < header.length; i++) {
            resultSet.addColumn(header[i], Types.VARCHAR, 0);
        }

        // Add rows to the result set
        for (String[] row : data) {
            resultSet.addRow(row);
        }

        // Return the ResultSet
        return resultSet;
    }

    public static void main(String[] args) {
        String filePath = "path/to/your/file.csv";
        try {
            ResultSet resultSet = createResultSetFromFile(filePath);
            // Use the resultSet as needed

            // Remember to close the resultSet when you're done using it
            resultSet.close();
        } catch (IOException | CsvException | SQLException e) {
            e.printStackTrace();
        }
    }
}
