import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import java.io.*;

public class UniformFontStyling {

    public static void main(String[] args) {
        try {
            // Load the existing XLSX file
            FileInputStream fileInputStream = new FileInputStream("input.xlsx");
            XSSFWorkbook workbook = new XSSFWorkbook(fileInputStream);
            
            // Create a font with the desired style
            Font uniformFont = workbook.createFont();
            uniformFont.setFontName("Arial"); // Font name (e.g., Arial)
            uniformFont.setFontHeightInPoints((short) 12); // Font size
            uniformFont.setBold(true); // Bold
            uniformFont.setColor(IndexedColors.BLACK.getIndex()); // Font color (e.g., black)

            // Apply the uniform font style to all cells in all sheets
            for (int sheetIndex = 0; sheetIndex < workbook.getNumberOfSheets(); sheetIndex++) {
                XSSFSheet sheet = workbook.getSheetAt(sheetIndex);
                for (Row row : sheet) {
                    for (Cell cell : row) {
                        CellStyle cellStyle = cell.getCellStyle();
                        cellStyle.setFont(uniformFont);
                        cell.setCellStyle(cellStyle);
                    }
                }
            }

            // Save the modified workbook to a new file
            FileOutputStream fileOutputStream = new FileOutputStream("output.xlsx");
            workbook.write(fileOutputStream);
            fileOutputStream.close();
            workbook.close();

            System.out.println("Uniform font styling applied successfully.");
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
