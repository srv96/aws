import software.amazon.awssdk.services.athena.AthenaClient;
import software.amazon.awssdk.services.athena.model.*;
import software.amazon.awssdk.services.athena.paginators.QueryResultsIterable;

public class AthenaPaginatorExample {

    public static void main(String[] args) {

        AthenaClient client = AthenaClient.create();

        String queryExecutionId = "abcd-1234-efgh-5678";

        // Create a request to retrieve the query results
        GetQueryResultsRequest getQueryResultsRequest = GetQueryResultsRequest.builder()
                .queryExecutionId(queryExecutionId)
                .build();

        // Use the paginator to retrieve all query results
        QueryResultsIterable queryResults = client.paginators().getQueryResultsIterable(getQueryResultsRequest);

        // Iterate over the pages of query results
        for (GetQueryResultsResponse page : queryResults) {
            // Process each page of query results
            for (Row row : page.resultSet().rows()) {
                // Process each row of the result set
                for (Datum datum : row.data()) {
                    // Process each column in the row
                    System.out.print(datum.varCharValue() + "\t");
                }
                System.out.println();
            }
        }
    }
}
