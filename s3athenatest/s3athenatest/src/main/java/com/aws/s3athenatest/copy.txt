
provider "aws" {
  region = "us-west-2" # Replace with your desired region
}

module "s3_bucket" {
  source = "terraform-aws-modules/s3-bucket/aws"
  version = "2.3.0"
  
  name = "my-bucket"
  acl = "private"
  versioning_enabled = true
  
  lifecycle_rules = [
    {
      id      = "current-objects-to-standard-ia"
      status  = "Enabled"
      prefix  = ""
      enabled = true
      transition = [
        {
          days          = 30
          storage_class = "STANDARD_IA"
        }
      ]
    },
    {
      id      = "current-objects-to-glacier"
      status  = "Enabled"
      prefix  = ""
      enabled = true
      transition = [
        {
          days          = 60
          storage_class = "GLACIER"
        }
      ]
    },
    {
      id      = "current-objects-to-deep-archive"
      status  = "Enabled"
      prefix  = ""
      enabled = true
      transition = [
        {
          days          = 90
          storage_class = "DEEP_ARCHIVE"
        }
      ]
    },
    {
      id      = "noncurrent-objects-to-glacier"
      status  = "Enabled"
      prefix  = ""
      enabled = true
      noncurrent_version_transition = [
        {
          days          = 60
          storage_class = "GLACIER"
        }
      ]
    },
    {
      id      = "noncurrent-objects-to-deep-archive"
      status  = "Enabled"
      prefix  = ""
      enabled = true
      noncurrent_version_transition = [
        {
          days          = 90
          storage_class = "DEEP_ARCHIVE"
        }
      ]
    },
  ]
}
