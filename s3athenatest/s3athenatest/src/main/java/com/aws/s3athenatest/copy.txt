
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class PreparedStatementExample {

    private static final String DB_URL = "jdbc:mysql://localhost:3306/mydatabase";
    private static final String USER = "myuser";
    private static final String PASS = "mypassword";

    public static void main(String[] args) {

        try (Connection conn = DriverManager.getConnection(DB_URL, USER, PASS)) {

            // Insert data into the database using a prepared statement
            String insertSql = "INSERT INTO mytable (column1, column2, column3) VALUES (?, ?, ?)";
            try (PreparedStatement insertStatement = conn.prepareStatement(insertSql)) {
                insertStatement.setString(1, "value1");
                insertStatement.setString(2, "value2");
                insertStatement.setInt(3, 123);
                int rowsInserted = insertStatement.executeUpdate();
                System.out.println("Rows inserted: " + rowsInserted);
            }

            // Update data in the database using a prepared statement
            String updateSql = "UPDATE mytable SET column1 = ? WHERE column2 = ?";
            try (PreparedStatement updateStatement = conn.prepareStatement(updateSql)) {
                updateStatement.setString(1, "new value");
                updateStatement.setString(2, "value2");
                int rowsUpdated = updateStatement.executeUpdate();
                System.out.println("Rows updated: " + rowsUpdated);
            }

            // Delete data from the database using a prepared statement
            String deleteSql = "DELETE FROM mytable WHERE column3 = ?";
            try (PreparedStatement deleteStatement = conn.prepareStatement(deleteSql)) {
                deleteStatement.setInt(1, 123);
                int rowsDeleted = deleteStatement.executeUpdate();
                System.out.println("Rows deleted: " + rowsDeleted);
            }

            // Retrieve data from the database using a prepared statement
            String selectSql = "SELECT * FROM mytable WHERE column2 = ?";
            try (PreparedStatement selectStatement = conn.prepareStatement(selectSql)) {
                selectStatement.setString(1, "value2");
                try (ResultSet resultSet = selectStatement.executeQuery()) {
                    while (resultSet.next()) {
                        String column1Value = resultSet.getString("column1");
                        int column3Value = resultSet.getInt("column3");
                        System.out.println("column1 = " + column1Value + ", column3 = " + column3Value);
                    }
                }
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }

    }

}
